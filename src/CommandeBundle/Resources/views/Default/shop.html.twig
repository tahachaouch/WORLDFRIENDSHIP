{% extends 'base.html.twig' %}

{% block body %}
<section class="banner_area" style="background-image:{{ asset('uploads/images/cart2.jpg' ) }} ">
    <div class="container">
        <div class="banner_content">
            <h3 title="Shop"><img class="left_img" src="img/banner/t-left-img.png" alt="">Boutique<img class="right_img" src="img/banner/t-right-img.png" alt=""></h3>
            <a href="index.html">Home</a>
            <a href="{{ path ('shop') }}">Shop</a>
            <ul class="shop_banner_cart">
                <li><a href="{{ path('commande_cart') }}"><i class="fa fa-shopping-cart" aria-hidden="true"></i></a></li>
                <li><a href="{{ path ('produit_wishlist') }}"><i class="fa fa-heart" aria-hidden="true"></i></a></li>
            </ul>
        </div>
    </div>
</section>
<!--================End Banner Area =================-->

<!--================Shop left sidebar Area =================-->
<section class="shop_area shop_left_sidebar_area">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <div class="row">
                    {% for produit in produits %}
                    <div class="col-md-4 col-sm-6">
                        <div class="product_item">
                            <div class="product_img">
                                <img src="{{ asset('uploads/images/' ~ produit.image) }}" style="width:250px ; height:250px">
                                <div class="new_tag">
                                    <h4>New</h4>
                                </div>
                                <div class="hover_icon">
                                    <ul>
                                        <li><a href="{{ path('commande_add', { 'id': produit.idProd,'q':1 }) }}"><i class="fa fa-shopping-cart" aria-hidden="true"></i></a></li>
                                        <li><a href="#"><i class="fa fa-heart" aria-hidden="true"></i></a></li>
                                        <li><a href="{{ path('produit_show', { 'id': produit.idProd }) }}"><i class="fa fa-eye" aria-hidden="true"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <h5>{{ produit.nomProd }}</h5>
                            <h6> {{ produit.prix }} TND</h6>
                        </div>
                    </div>

                    {% endfor %}
                </div>
                <div class="pagination_area">
                {{ knp_pagination_render(produits) }}
                </div>
            </div>
            <div class="col-md-3">
                <div class="right_sidebar_area">
                    <aside class="s_widget search_widget">
                        <div class="input-group">
                            <input type="text" id="search" class="form-control" placeholder="Rechercher Ici">
                            <span class="input-group-btn">
                                        <button class="btn btn-default" type="button"><i class="fa fa-search" aria-hidden="true"></i></button>
                            </span>
                            <script type="text/javascript" src=""></script>
                        </div>
                    </aside>
                    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

                    <script type="text/javascript">
                        jQuery(document).ready(function() {
                            var searchRequest = null;
                            $("#search").keyup(function() {
                                var minlength = 1;
                                var that = this;
                                var value = $(this).val();
                                var entitySelector = $("#entitiesNav").html('');
                                if (value.length >= minlength ) {
                                    if (searchRequest != null)
                                        searchRequest.abort();
                                    searchRequest = $.ajax({
                                        type: "GET",
                                        url: "{{ path('produit_search') }}",
                                        data: {
                                            'q' : value
                                        },
                                        dataType: "text",
                                        success: function(msg){
                                            //we need to check if the value is the same
                                            if (value===$(that).val()) {
                                                var result = JSON.parse(msg);
                                                $.each(result, function(key, arr) {
                                                    $.each(arr, function(id, value) {
                                                        if (key === 'produits') {
                                                            if (id !== 'error') {
                                                                console.log(value[1]);
                                                                entitySelector.append('<li><b>'+value[1]+'</b><a href="/show/'+id+'">'+'<img src="/uploads/images/'+value[0]+'" style="width: 50px; height: 50px"/>'+'</a></li>');
                                                            } else {
                                                                entitySelector.append('<li class="errorLi">'+value+'</li>');
                                                            }
                                                        }
                                                    });
                                                });
                                            }
                                        }
                                    });
                                }
                            });
                        });
                    </script>
                    <aside class="s_widget categories_widget">
                        <div class="s_title">
                            <h4>Categories</h4>
                            <img src="{{ asset ('templates/img/widget-title-border.png') }}" alt="">
                        </div>

                        <ul>
                            <li>
                                <a href=""><img src="{{ asset ('templates/img/categories-list.png')}}" alt="">Bagages</a>

                            </li>
                            <li>
                                <a href=""><img src="{{ asset ('templates/img/categories-list.png')}}" alt="">Confort</a>

                            </li>
                            <li>
                                <a href=""><img src="{{ asset ('templates/img/categories-list.png')}}" alt="">Sécurité</a>

                            </li>
                        </ul>

                    </aside>
                </div>
            </div>
        </div>

    </div>
</section>

{% endblock %}
